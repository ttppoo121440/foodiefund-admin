import{k as ge,c as A,d as Ce,e as R,g as pe,b as ie,f as Ee}from"./@babel-D4-ut-Uz.js";import{c as X}from"./classnames-BaEkKJlL.js";import{u as Re,B as Ae,r as de}from"./rc-input-CK5FyHxW.js";import{B as ve,u as fe,q as me}from"./rc-util-C7705Oj_.js";import{r as i,a as v}from"./react-Bi3d65_o.js";import{R as Ve}from"./rc-resize-observer-B6_Tj1-Q.js";var h,Fe=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],oe={};function Ne(t){var k=arguments.length>1&&arguments[1]!==void 0&&arguments[1],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;h||((h=document.createElement("textarea")).setAttribute("tab-index","-1"),h.setAttribute("aria-hidden","true"),document.body.appendChild(h)),t.getAttribute("wrap")?h.setAttribute("wrap",t.getAttribute("wrap")):h.removeAttribute("wrap");var S=function(x){var H=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=x.getAttribute("id")||x.getAttribute("data-reactid")||x.getAttribute("name");if(H&&oe[r])return oe[r];var o=window.getComputedStyle(x),w=o.getPropertyValue("box-sizing")||o.getPropertyValue("-moz-box-sizing")||o.getPropertyValue("-webkit-box-sizing"),T=parseFloat(o.getPropertyValue("padding-bottom"))+parseFloat(o.getPropertyValue("padding-top")),d=parseFloat(o.getPropertyValue("border-bottom-width"))+parseFloat(o.getPropertyValue("border-top-width")),g={sizingStyle:Fe.map(function(P){return"".concat(P,":").concat(o.getPropertyValue(P))}).join(";"),paddingSize:T,borderSize:d,boxSizing:w};return H&&r&&(oe[r]=g),g}(t,k),b=S.paddingSize,a=S.borderSize,m=S.boxSizing,V=S.sizingStyle;h.setAttribute("style","".concat(V,";").concat(`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`)),h.value=t.value||t.placeholder||"";var F,s=void 0,l=void 0,c=h.scrollHeight;if(m==="border-box"?c+=a:m==="content-box"&&(c-=b),n!==null||y!==null){h.value=" ";var N=h.scrollHeight-b;n!==null&&(s=N*n,m==="border-box"&&(s=s+b+a),c=Math.max(s,c)),y!==null&&(l=N*y,m==="border-box"&&(l=l+b+a),F=c>l?"":"hidden",c=Math.min(l,c))}var u={height:c,overflowY:F,resize:"none"};return s&&(u.minHeight=s),l&&(u.maxHeight=l),u}var Pe=["prefixCls","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],He=i.forwardRef(function(t,k){var n=t,y=n.prefixCls,S=n.defaultValue,b=n.value,a=n.autoSize,m=n.onResize,V=n.className,F=n.style,s=n.disabled,l=n.onChange;n.onInternalAutoSize;var c=ge(n,Pe),N=ve(S,{value:b,postState:function(f){return f??""}}),u=A(N,2),x=u[0],H=u[1],r=i.useRef();i.useImperativeHandle(k,function(){return{textArea:r.current}});var o=i.useMemo(function(){return a&&Ce(a)==="object"?[a.minRows,a.maxRows]:[]},[a]),w=A(o,2),T=w[0],d=w[1],g=!!a,P=i.useState(2),G=A(P,2),z=G[0],B=G[1],J=i.useState(),I=A(J,2),U=I[0],Z=I[1],L=function(){B(0)};fe(function(){g&&L()},[b,T,d,g]),fe(function(){if(z===0)B(1);else if(z===1){var f=Ne(r.current,!1,T,d);B(2),Z(f)}else(function(){try{if(document.activeElement===r.current){var W=r.current,j=W.selectionStart,Y=W.selectionEnd,_=W.scrollTop;r.current.setSelectionRange(j,Y),r.current.scrollTop=_}}catch{}})()},[z]);var O=i.useRef(),D=function(){me.cancel(O.current)};i.useEffect(function(){return D},[]);var K=g?U:null,M=R(R({},F),K);return z!==0&&z!==1||(M.overflowY="hidden",M.overflowX="hidden"),i.createElement(Ve,{onResize:function(f){z===2&&(m==null||m(f),a&&(D(),O.current=me(function(){L()})))},disabled:!(a||m)},i.createElement("textarea",pe({},c,{ref:r,style:M,className:X(y,V,ie({},"".concat(y,"-disabled"),s)),disabled:s,value:x,onChange:function(f){H(f.target.value),l==null||l(f)}})))}),Te=["defaultValue","value","onFocus","onBlur","onChange","allowClear","maxLength","onCompositionStart","onCompositionEnd","suffix","prefixCls","showCount","count","className","style","disabled","hidden","classNames","styles","onResize","onClear","onPressEnter","readOnly","autoSize","onKeyDown"],Ke=v.forwardRef(function(t,k){var n,y=t.defaultValue,S=t.value,b=t.onFocus,a=t.onBlur,m=t.onChange,V=t.allowClear,F=t.maxLength,s=t.onCompositionStart,l=t.onCompositionEnd,c=t.suffix,N=t.prefixCls,u=N===void 0?"rc-textarea":N,x=t.showCount,H=t.count,r=t.className,o=t.style,w=t.disabled,T=t.hidden,d=t.classNames,g=t.styles,P=t.onResize,G=t.onClear,z=t.onPressEnter,B=t.readOnly,J=t.autoSize,I=t.onKeyDown,U=ge(t,Te),Z=ve(y,{value:S,defaultValue:y}),L=A(Z,2),O=L[0],D=L[1],K=O==null?"":String(O),M=v.useState(!1),f=A(M,2),W=f[0],j=f[1],Y=v.useRef(!1),_=v.useState(null),$=A(_,2),he=$[0],be=$[1],le=i.useRef(null),ee=i.useRef(null),C=function(){var e;return(e=ee.current)===null||e===void 0?void 0:e.textArea},ue=function(){C().focus()};i.useImperativeHandle(k,function(){var e;return{resizableTextArea:ee.current,focus:ue,blur:function(){C().blur()},nativeElement:((e=le.current)===null||e===void 0?void 0:e.nativeElement)||C()}}),i.useEffect(function(){j(function(e){return!w&&e})},[w]);var xe=v.useState(null),se=A(xe,2),te=se[0],ye=se[1];v.useEffect(function(){var e;te&&(e=C()).setSelectionRange.apply(e,Ee(te))},[te]);var Q,p=Re(H,x),q=(n=p.max)!==null&&n!==void 0?n:F,we=Number(q)>0,ne=p.strategy(K),ze=!!q&&ne>q,ce=function(e,E){var re=E;!Y.current&&p.exceedFormatter&&p.max&&p.strategy(E)>p.max&&E!==(re=p.exceedFormatter(E,{max:p.max}))&&ye([C().selectionStart||0,C().selectionEnd||0]),D(re),de(e.currentTarget,e,m,re)},ae=c;p.show&&(Q=p.showFormatter?p.showFormatter({value:K,count:ne,maxLength:q}):"".concat(ne).concat(we?" / ".concat(q):""),ae=v.createElement(v.Fragment,null,ae,v.createElement("span",{className:X("".concat(u,"-data-count"),d==null?void 0:d.count),style:g==null?void 0:g.count},Q)));var Se=!J&&!x&&!V;return v.createElement(Ae,{ref:le,value:K,allowClear:V,handleReset:function(e){D(""),ue(),de(C(),e,m)},suffix:ae,prefixCls:u,classNames:R(R({},d),{},{affixWrapper:X(d==null?void 0:d.affixWrapper,ie(ie({},"".concat(u,"-show-count"),x),"".concat(u,"-textarea-allow-clear"),V))}),disabled:w,focused:W,className:X(r,ze&&"".concat(u,"-out-of-range")),style:R(R({},o),he&&!Se?{height:"auto"}:{}),dataAttrs:{affixWrapper:{"data-count":typeof Q=="string"?Q:void 0}},hidden:T,readOnly:B,onClear:G},v.createElement(He,pe({},U,{autoSize:J,maxLength:F,onKeyDown:function(e){e.key==="Enter"&&z&&z(e),I==null||I(e)},onChange:function(e){ce(e,e.target.value)},onFocus:function(e){j(!0),b==null||b(e)},onBlur:function(e){j(!1),a==null||a(e)},onCompositionStart:function(e){Y.current=!0,s==null||s(e)},onCompositionEnd:function(e){Y.current=!1,ce(e,e.currentTarget.value),l==null||l(e)},className:X(d==null?void 0:d.textarea),style:R(R({},g==null?void 0:g.textarea),{},{resize:o==null?void 0:o.resize}),disabled:w,prefixCls:u,onResize:function(e){var E;P==null||P(e),(E=C())!==null&&E!==void 0&&E.style.height&&be(!0)},ref:ee,readOnly:B})))});export{Ke as T};
