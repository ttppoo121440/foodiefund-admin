import{c as K,d as de,g as ee,b as ue,k as ye,e as z,f as V}from"./@babel-D4-ut-Uz.js";import{r as o,a as Y}from"./react-Bi3d65_o.js";import{r as xe}from"./react-dom-DttoD7qq.js";import{c as $}from"./classnames-BaEkKJlL.js";import{a as be}from"./rc-motion-C1KiqwsE.js";import{A as Re,K as Ae}from"./rc-util-C7705Oj_.js";var we=o.forwardRef(function(e,v){var E=e.prefixCls,A=e.style,w=e.className,C=e.duration,y=C===void 0?4.5:C,p=e.showProgress,g=e.pauseOnHover,S=g===void 0||g,D=e.eventKey,M=e.content,h=e.closable,j=e.closeIcon,L=j===void 0?"x":j,l=e.props,i=e.onClick,T=e.onNoticeClose,F=e.times,f=e.hovering,b=o.useState(!1),R=K(b,2),H=R[0],a=R[1],t=o.useState(0),n=K(t,2),r=n[0],c=n[1],s=o.useState(0),d=K(s,2),k=d[0],B=d[1],G=f||H,W=y>0&&p,J=function(){T(D)};o.useEffect(function(){if(!G&&y>0){var u=Date.now()-k,N=setTimeout(function(){J()},1e3*y-k);return function(){S&&clearTimeout(N),B(Date.now()-u)}}},[y,G,F]),o.useEffect(function(){if(!G&&W&&(S||k===0)){var u,N=performance.now();return function Z(){cancelAnimationFrame(u),u=requestAnimationFrame(function(q){var te=q+k-N,x=Math.min(te/(1e3*y),1);c(100*x),x<1&&Z()})}(),function(){S&&cancelAnimationFrame(u)}}},[y,k,G,W,F]);var m=o.useMemo(function(){return de(h)==="object"&&h!==null?h:h?{closeIcon:L}:{}},[h,L]),P=Re(m,!0),X=100-(!r||r<0?0:r>100?100:r),I="".concat(E,"-notice");return o.createElement("div",ee({},l,{ref:v,className:$(I,w,ue({},"".concat(I,"-closable"),h)),style:A,onMouseEnter:function(u){var N;a(!0),l==null||(N=l.onMouseEnter)===null||N===void 0||N.call(l,u)},onMouseLeave:function(u){var N;a(!1),l==null||(N=l.onMouseLeave)===null||N===void 0||N.call(l,u)},onClick:i}),o.createElement("div",{className:"".concat(I,"-content")},M),h&&o.createElement("a",ee({tabIndex:0,className:"".concat(I,"-close"),onKeyDown:function(u){u.key!=="Enter"&&u.code!=="Enter"&&u.keyCode!==Ae.ENTER||J()},"aria-label":"Close"},P,{onClick:function(u){u.preventDefault(),u.stopPropagation(),J()}}),m.closeIcon),W&&o.createElement("progress",{className:"".concat(I,"-progress"),max:"100",value:X},X+"%"))}),pe=Y.createContext({}),De=function(e){var v=e.children,E=e.classNames;return Y.createElement(pe.Provider,{value:{classNames:E}},v)},Se=["className","style","classNames","styles"],Me=function(e){var v,E,A,w,C,y=e.configList,p=e.placement,g=e.prefixCls,S=e.className,D=e.style,M=e.motion,h=e.onAllNoticeRemoved,j=e.onNoticeClose,L=e.stack,l=o.useContext(pe).classNames,i=o.useRef({}),T=o.useState(null),F=K(T,2),f=F[0],b=F[1],R=o.useState([]),H=K(R,2),a=H[0],t=H[1],n=y.map(function(m){return{config:m,key:String(m.key)}}),r=(C={offset:8,threshold:3,gap:16},(v=L)&&de(v)==="object"&&(C.offset=(E=v.offset)!==null&&E!==void 0?E:8,C.threshold=(A=v.threshold)!==null&&A!==void 0?A:3,C.gap=(w=v.gap)!==null&&w!==void 0?w:16),[!!v,C]),c=K(r,2),s=c[0],d=c[1],k=d.offset,B=d.threshold,G=d.gap,W=s&&(a.length>0||n.length<=B),J=typeof M=="function"?M(p):M;return o.useEffect(function(){s&&a.length>1&&t(function(m){return m.filter(function(P){return n.some(function(X){var I=X.key;return P===I})})})},[a,n,s]),o.useEffect(function(){var m,P;s&&i.current[(m=n[n.length-1])===null||m===void 0?void 0:m.key]&&b(i.current[(P=n[n.length-1])===null||P===void 0?void 0:P.key])},[n,s]),Y.createElement(be,ee({key:p,className:$(g,"".concat(g,"-").concat(p),l==null?void 0:l.list,S,ue(ue({},"".concat(g,"-stack"),!!s),"".concat(g,"-stack-expanded"),W)),style:D,keys:n,motionAppear:!0},J,{onAllRemoved:function(){h(p)}}),function(m,P){var X=m.config,I=m.className,u=m.style,N=m.index,Z=X,q=Z.key,te=Z.times,x=String(q),Q=X,ge=Q.className,he=Q.style,ne=Q.classNames,oe=Q.styles,ke=ye(Q,Se),re=n.findIndex(function(O){return O.key===x}),_={};if(s){var U=n.length-1-(re>-1?re:N-1),fe=p==="top"||p==="bottom"?"-50%":"0";if(U>0){var ce,ae,se;_.height=W?(ce=i.current[x])===null||ce===void 0?void 0:ce.offsetHeight:f==null?void 0:f.offsetHeight;for(var me=0,ie=0;ie<U;ie++){var le;me+=((le=i.current[n[n.length-1-ie].key])===null||le===void 0?void 0:le.offsetHeight)+G}var Ne=(W?me:U*k)*(p.startsWith("top")?1:-1),Ee=!W&&f!=null&&f.offsetWidth&&(ae=i.current[x])!==null&&ae!==void 0&&ae.offsetWidth?((f==null?void 0:f.offsetWidth)-2*k*(U<3?U:3))/((se=i.current[x])===null||se===void 0?void 0:se.offsetWidth):1;_.transform="translate3d(".concat(fe,", ").concat(Ne,"px, 0) scaleX(").concat(Ee,")")}else _.transform="translate3d(".concat(fe,", 0, 0)")}return Y.createElement("div",{ref:P,className:$("".concat(g,"-notice-wrapper"),I,ne==null?void 0:ne.wrapper),style:z(z(z({},u),_),oe==null?void 0:oe.wrapper),onMouseEnter:function(){return t(function(O){return O.includes(x)?O:[].concat(V(O),[x])})},onMouseLeave:function(){return t(function(O){return O.filter(function(Ce){return Ce!==x})})}},Y.createElement(we,ee({},ke,{ref:function(O){re>-1?i.current[x]=O:delete i.current[x]},prefixCls:g,classNames:ne,styles:oe,className:$(ge,l==null?void 0:l.notice),style:he,times:te,key:q,eventKey:q,onNoticeClose:j,hovering:s&&a.length>0})))})},je=o.forwardRef(function(e,v){var E=e.prefixCls,A=E===void 0?"rc-notification":E,w=e.container,C=e.motion,y=e.maxCount,p=e.className,g=e.style,S=e.onAllRemoved,D=e.stack,M=e.renderNotifications,h=o.useState([]),j=K(h,2),L=j[0],l=j[1],i=function(t){var n,r=L.find(function(c){return c.key===t});r==null||(n=r.onClose)===null||n===void 0||n.call(r),l(function(c){return c.filter(function(s){return s.key!==t})})};o.useImperativeHandle(v,function(){return{open:function(t){l(function(n){var r,c=V(n),s=c.findIndex(function(k){return k.key===t.key}),d=z({},t);return s>=0?(d.times=(((r=n[s])===null||r===void 0?void 0:r.times)||0)+1,c[s]=d):(d.times=0,c.push(d)),y>0&&c.length>y&&(c=c.slice(-y)),c})},close:function(t){i(t)},destroy:function(){l([])}}});var T=o.useState({}),F=K(T,2),f=F[0],b=F[1];o.useEffect(function(){var t={};L.forEach(function(n){var r=n.placement,c=r===void 0?"topRight":r;c&&(t[c]=t[c]||[],t[c].push(n))}),Object.keys(f).forEach(function(n){t[n]=t[n]||[]}),b(t)},[L]);var R=function(t){b(function(n){var r=z({},n);return(r[t]||[]).length||delete r[t],r})},H=o.useRef(!1);if(o.useEffect(function(){Object.keys(f).length>0?H.current=!0:H.current&&(S==null||S(),H.current=!1)},[f]),!w)return null;var a=Object.keys(f);return xe.createPortal(o.createElement(o.Fragment,null,a.map(function(t){var n=f[t],r=o.createElement(Me,{key:t,configList:n,placement:t,prefixCls:A,className:p==null?void 0:p(t),style:g==null?void 0:g(t),motion:C,onNoticeClose:i,onAllNoticeRemoved:R,stack:D});return M?M(r,{prefixCls:A,key:t}):r})),w)}),Le=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],Fe=function(){return document.body},ve=0;function Te(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},v=e.getContainer,E=v===void 0?Fe:v,A=e.motion,w=e.prefixCls,C=e.maxCount,y=e.className,p=e.style,g=e.onAllRemoved,S=e.stack,D=e.renderNotifications,M=ye(e,Le),h=o.useState(),j=K(h,2),L=j[0],l=j[1],i=o.useRef(),T=o.createElement(je,{container:L,ref:i,prefixCls:w,motion:A,maxCount:C,className:y,style:p,onAllRemoved:g,stack:S,renderNotifications:D}),F=o.useState([]),f=K(F,2),b=f[0],R=f[1],H=o.useMemo(function(){return{open:function(a){var t=function(){for(var n={},r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return c.forEach(function(d){d&&Object.keys(d).forEach(function(k){var B=d[k];B!==void 0&&(n[k]=B)})}),n}(M,a);t.key!==null&&t.key!==void 0||(t.key="rc-notification-".concat(ve),ve+=1),R(function(n){return[].concat(V(n),[{type:"open",config:t}])})},close:function(a){R(function(t){return[].concat(V(t),[{type:"close",key:a}])})},destroy:function(){R(function(a){return[].concat(V(a),[{type:"destroy"}])})}}},[]);return o.useEffect(function(){l(E())}),o.useEffect(function(){i.current&&b.length&&(b.forEach(function(a){switch(a.type){case"open":i.current.open(a.config);break;case"close":i.current.close(a.key);break;case"destroy":i.current.destroy()}}),R(function(a){return a.filter(function(t){return!b.includes(t)})}))},[b]),[H,T]}export{we as N,De as a,Te as u};
