import{k as fe,c as ce,g as ue,b as se}from"./@babel-D4-ut-Uz.js";import{T as pe}from"./@rc-component-DkdjcAXV.js";import{c as B}from"./classnames-BaEkKJlL.js";import{q as ve,K as H,f as I,s as K}from"./rc-util-C7705Oj_.js";import{r as d,a as o}from"./react-Bi3d65_o.js";var me=H.ESC,de=H.TAB,ge=d.forwardRef(function(e,g){var r=e.overlay,s=e.arrow,p=e.prefixCls,i=d.useMemo(function(){return typeof r=="function"?r():r},[r]),a=I(g,i==null?void 0:i.ref);return o.createElement(o.Fragment,null,s&&o.createElement("div",{className:"".concat(p,"-arrow")}),o.cloneElement(i,{ref:K(i)?a:void 0}))}),c={adjustX:1,adjustY:1},u=[0,0],we={topLeft:{points:["bl","tl"],overflow:c,offset:[0,-4],targetOffset:u},top:{points:["bc","tc"],overflow:c,offset:[0,-4],targetOffset:u},topRight:{points:["br","tr"],overflow:c,offset:[0,-4],targetOffset:u},bottomLeft:{points:["tl","bl"],overflow:c,offset:[0,4],targetOffset:u},bottom:{points:["tc","bc"],overflow:c,offset:[0,4],targetOffset:u},bottomRight:{points:["tr","br"],overflow:c,offset:[0,4],targetOffset:u}},he=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function be(e,g){var r,s=e.arrow,p=s!==void 0&&s,i=e.prefixCls,a=i===void 0?"rc-dropdown":i,X=e.transitionName,Y=e.animation,z=e.align,y=e.placement,G=y===void 0?"bottomLeft":y,C=e.placements,J=C===void 0?we:C,Q=e.getPopupContainer,U=e.showAction,Z=e.hideAction,_=e.overlayClassName,$=e.overlayStyle,ee=e.visible,R=e.trigger,E=R===void 0?["hover"]:R,oe=e.autoFocus,N=e.overlay,v=e.children,O=e.onVisibleChange,te=fe(e,he),ne=o.useState(),A=ce(ne,2),re=A[0],k=A[1],w="visible"in e?ee:re,x=o.useRef(null),P=o.useRef(null),V=o.useRef(null);o.useImperativeHandle(g,function(){return x.current});var F=function(n){k(n),O==null||O(n)};(function(n){var l=n.visible,ae=n.triggerRef,M=n.onVisibleChange,le=n.autoFocus,W=n.overlayRef,m=d.useRef(!1),j=function(){var t,f;l&&((t=ae.current)===null||t===void 0||(f=t.focus)===null||f===void 0||f.call(t),M==null||M(!1))},D=function(){var t;return!((t=W.current)===null||t===void 0||!t.focus||(W.current.focus(),m.current=!0,0))},q=function(t){switch(t.keyCode){case me:j();break;case de:var f=!1;m.current||(f=D()),f?t.preventDefault():j()}};d.useEffect(function(){return l?(window.addEventListener("keydown",q),le&&ve(D,3),function(){window.removeEventListener("keydown",q),m.current=!1}):function(){m.current=!1}},[l])})({visible:w,triggerRef:V,onVisibleChange:F,autoFocus:oe,overlayRef:P});var h,L,S,T=function(){return o.createElement(ge,{ref:P,overlay:N,prefixCls:a,arrow:p})},ie=o.cloneElement(v,{className:B((r=v.props)===null||r===void 0?void 0:r.className,w&&(h=e.openClassName,h!==void 0?h:"".concat(a,"-open"))),ref:K(v)?I(V,v.ref):void 0}),b=Z;return b||E.indexOf("contextMenu")===-1||(b=["click"]),o.createElement(pe,ue({builtinPlacements:J},te,{prefixCls:a,ref:x,popupClassName:B(_,se({},"".concat(a,"-show-arrow"),p)),popupStyle:$,action:E,showAction:U,hideAction:b,popupPlacement:G,popupAlign:z,popupTransitionName:X,popupAnimation:Y,popupVisible:w,stretch:(L=e.minOverlayWidthMatchTrigger,S=e.alignPoint,("minOverlayWidthMatchTrigger"in e?L:!S)?"minWidth":""),popup:typeof N=="function"?T:T(),onPopupVisibleChange:F,onPopupClick:function(n){var l=e.onOverlayClick;k(!1),l&&l(n)},getPopupContainer:Q}),ie)}const Oe=o.forwardRef(be);export{Oe as D};
