import{h as _,i as q,a as A,_ as D,e as B,d as F,g as G}from"./@babel-D4-ut-Uz.js";import{r as t}from"./react-Bi3d65_o.js";import{s as J,e as K,N as C,x as L}from"./rc-util-C7705Oj_.js";import{i as O}from"./resize-observer-polyfill-BT-ZEh6l.js";var y=t.createContext(null),s=new Map,j=new O(function(u){u.forEach(function(i){var e,o=i.target;(e=s.get(o))===null||e===void 0||e.forEach(function(r){return r(o)})})}),Q=function(u){_(e,u);var i=q(e);function e(){return A(this,e),i.apply(this,arguments)}return D(e,[{key:"render",value:function(){return this.props.children}}]),e}(t.Component);function T(u,i){var e=u.children,o=u.disabled,r=t.useRef(null),a=t.useRef(null),m=t.useContext(y),d=typeof e=="function",f=d?e(r):e,c=t.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),g=!d&&t.isValidElement(f)&&J(f),I=g?f.ref:null,N=K(I,r),k=function(){var n;return C(r.current)||(r.current&&F(r.current)==="object"?C((n=r.current)===null||n===void 0?void 0:n.nativeElement):null)||C(a.current)};t.useImperativeHandle(i,function(){return k()});var H=t.useRef(u);H.current=u;var x=t.useCallback(function(n){var v=H.current,h=v.onResize,l=v.data,p=n.getBoundingClientRect(),E=p.width,b=p.height,R=n.offsetWidth,w=n.offsetHeight,M=Math.floor(E),W=Math.floor(b);if(c.current.width!==M||c.current.height!==W||c.current.offsetWidth!==R||c.current.offsetHeight!==w){var z={width:M,height:W,offsetWidth:R,offsetHeight:w};c.current=z;var S=R===Math.round(E)?E:R,V=w===Math.round(b)?b:w,P=B(B({},z),{},{offsetWidth:S,offsetHeight:V});m==null||m(P,n,l),h&&Promise.resolve().then(function(){h(P,n)})}},[]);return t.useEffect(function(){var n,v,h=k();return h&&!o&&(n=h,v=x,s.has(n)||(s.set(n,new Set),j.observe(n)),s.get(n).add(v)),function(){return function(l,p){s.has(l)&&(s.get(l).delete(p),s.get(l).size||(j.unobserve(l),s.delete(l)))}(h,x)}},[r.current,o]),t.createElement(Q,{ref:a},g?t.cloneElement(f,{ref:N}):f)}var U=t.forwardRef(T);function X(u,i){var e=u.children;return(typeof e=="function"?[e]:L(e)).map(function(o,r){var a=(o==null?void 0:o.key)||"".concat("rc-observer-key","-").concat(r);return t.createElement(U,G({},u,{key:a,ref:r===0?i:void 0}),o)})}var Y=t.forwardRef(X);Y.Collection=function(u){var i=u.children,e=u.onBatchResize,o=t.useRef(0),r=t.useRef([]),a=t.useContext(y),m=t.useCallback(function(d,f,c){o.current+=1;var g=o.current;r.current.push({size:d,element:f,data:c}),Promise.resolve().then(function(){g===o.current&&(e==null||e(r.current),r.current=[])}),a==null||a(d,f,c)},[e,a]);return t.createElement(y.Provider,{value:m},i)};export{Y as R};
